<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="Amazon Lex Workshops" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="generator" content="Hugo 0.83.1" />
  <meta name="description" content="Amazon Lex Workshops">
<meta name="author" content="Andrew Kane">

  <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

  <title>Authentication and access :: Amazon Lex Workshops</title>

  
  <link href="../css/nucleus.css" rel="stylesheet">
  <link href="../css/fontawesome-all.min.css" rel="stylesheet">
  <link href="../css/hybrid.css" rel="stylesheet">
  <link href="../css/featherlight.min.css" rel="stylesheet">
  <link href="../css/perfect-scrollbar.min.css" rel="stylesheet">
  <link href="../css/auto-complete.css" rel="stylesheet">
  <link href="../css/atom-one-dark-reasonable.css" rel="stylesheet">
  <link href="../css/theme.css" rel="stylesheet">
  <link href="../css/hugo-theme.css" rel="stylesheet">
  
  <link href="../css/theme-aws.css" rel="stylesheet">
  

  <script src="../js/jquery-3.3.1.min.js"></script>

  <style>
    :root #header + #content > #left > #rlblock_left{
        display:none !important;
    }
    
  </style>
  
</head>

<body class="" data-url="../blogging-application/authentication.html">
  <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div>
    <a href="../" title="Go home">
        <img style="vertical-align:middle" src="../images/logo.png" height="70px" />
    </a>
</div>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js"></script>
<script type="text/javascript" src="../js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/introduction.html" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="../introduction.html">
          Introduction
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/introduction/setup-environment.html" title="Setup Dev Environment" class="dd-item 
        
        
        
        ">
      <a href="../introduction/setup-environment.html">
          Setup Dev Environment
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/introduction/install-prerequisites.html" title="Install Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="../introduction/install-prerequisites.html">
          Install Prerequisites
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/introduction/setup-project.html" title="Setup Project" class="dd-item 
        
        
        
        ">
      <a href="../introduction/setup-project.html">
          Setup Project
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blogging-application.html" title="Blogging Application" class="dd-item 
        parent
        
        
        ">
      <a href="../blogging-application.html">
          Blogging Application
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/blogging-application/create-api.html" title="Create a GraphQL API and database" class="dd-item 
        
        
        
        ">
      <a href="../blogging-application/create-api.html">
          Create a GraphQL API and database
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/blogging-application/server-side-rendering.html" title="API with Server-Side Rendering (SSR)" class="dd-item 
        
        
        
        ">
      <a href="../blogging-application/server-side-rendering.html">
          API with Server-Side Rendering (SSR)
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/blogging-application/incremental-static-site-generation.html" title="API with Incremental Static Site Generation (SSG)" class="dd-item 
        
        
        
        ">
      <a href="../blogging-application/incremental-static-site-generation.html">
          API with Incremental Static Site Generation (SSG)
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/blogging-application/deploy-and-host-app.html" title="Deploy and Host App" class="dd-item 
        
        
        
        ">
      <a href="../blogging-application/deploy-and-host-app.html">
          Deploy and Host App
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/blogging-application/authentication.html" title="Authentication and access" class="dd-item 
        parent
        active
        
        ">
      <a href="../blogging-application/authentication.html">
          Authentication and access
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/summary.html" title="Summary" class="dd-item 
        
        
        
        ">
      <a href="../summary.html">
          Summary
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="../credits.html"><i class='fas fa-bullhorn'></i> Workshop Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <left>

    <a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | Â© 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved. 

</left>

    </section>
  </div>
</nav>





  <section id="body">
    <div id="overlay"></div>
    <div class="padding highlightable">
      
      <div>
        <div id="top-bar">
          
          
          <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            
            <span class="links">
              
          
          
          
          
          
          
          
          
          
          
          <a href='../'>AWS Amplify Workshop</a> > <a href='../blogging-application.html'>Blogging Application</a> > Authentication and access
          
          
          
          
          
          
            </span>
          </div>
          
          <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents"></nav>
    </div>
</div>

          
        </div>
      </div>
      

      
        <div id="body-inner">
          <h1>Authentication and access</h1>
          
          



	<p>Our blogging application is working pretty well, but currently anyone can access our application and create or even delete any blog entry. This presents a serious security and usability problem. Fortunately, Amplify makes it very easy to add authentication and then provide granular access controls.</p>
<p>Let&rsquo;s begin by updating our GraphQL schema. Open the file <strong>amplify/backend/api/nextamplified/schema.graphql</strong> in your Cloud9 IDE and paste in the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Post</span>
  <span style="color:#a6e22e">@model</span>
  <span style="color:#a6e22e">@auth</span>(rules: [{ <span style="color:#a6e22e">allow</span>: <span style="color:#a6e22e">owner</span> }, { allow: <span style="color:#a6e22e">public</span>, operations: [<span style="color:#a6e22e">read</span>] }]) {
  id: <span style="color:#a6e22e">ID</span>!
  title: <span style="color:#a6e22e">String</span>!
  content: <span style="color:#a6e22e">String</span>!
}
</code></pre></div><p>Notice that this updated schema is nearly identical to our original schema! In fact, the only difference is on the line that begins with @auth. What we&rsquo;ve done here is removed Create, Update, and Delete permissions from <strong>public</strong> access and added an <strong>allow: owner</strong> directive, which grants full access to a Post to the owner of that Post.</p>
<p>After you have saved your updated schema, let&rsquo;s check in with Amplify and see how the updated schema has impacted Amplify&rsquo;s understanding of the project status.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">amplify status
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; Current Environment: dev
    
ââââââââââââ¬âââââââââââââââââ¬ââââââââââââ¬ââââââââââââââââââââ
â Category â Resource name  â Operation â Provider plugin   â
ââââââââââââ¼âââââââââââââââââ¼ââââââââââââ¼ââââââââââââââââââââ¤
â Api      â nextamplified  â Update    â awscloudformation â
ââââââââââââ¼âââââââââââââââââ¼ââââââââââââ¼ââââââââââââââââââââ¤
â Hosting  â amplifyhosting â No Change â                   â
ââââââââââââ´âââââââââââââââââ´ââââââââââââ´ââââââââââââââââââââ
</code></pre></div><p>As you can see, Amplify detected that there was a change needed in the API due to our schema change. Let&rsquo;s go ahead and update our environment in the cloud with these updates.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">amplify push
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; Current Environment: dev
    
ââââââââââââ¬âââââââââââââââââ¬ââââââââââââ¬ââââââââââââââââââââ
â Category â Resource name  â Operation â Provider plugin   â
ââââââââââââ¼âââââââââââââââââ¼ââââââââââââ¼ââââââââââââââââââââ¤
â Api      â nextamplified  â Update    â awscloudformation â
ââââââââââââ¼âââââââââââââââââ¼ââââââââââââ¼ââââââââââââââââââââ¤
â Hosting  â amplifyhosting â No Change â                   â
ââââââââââââ´âââââââââââââââââ´ââââââââââââ´ââââââââââââââââââââ
? Are you sure you want to <span style="color:#66d9ef">continue</span>? Yes

â ï¸  WARNING: your GraphQL API currently allows public create, read, update, and delete access to all models via an API Key. To configure PRODUCTION-READY authorization rules, review: https://docs.amplify.aws/cli/graphql/authorization-rules

Cognito UserPool configuration
Using service: Cognito, provided by: awscloudformation
 
 The current configured provider is Amazon Cognito. 
 
 Do you want to use the default authentication and security configuration? <span style="color:#f92672">(</span>Use arrow keys<span style="color:#f92672">)</span>
â¯ Default configuration 
  Default configuration with Social Provider <span style="color:#f92672">(</span>Federation<span style="color:#f92672">)</span> 
  Manual configuration 
  I want to learn more. 
</code></pre></div><p>As you can see, Amplify detected that we needed to add authentication due to our updated @auth directive in the schema and automatically began the process of adding Amazon Cognito as our provider. Select all of the default settings for Cognito.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> Do you want to use the default authentication and security configuration? Default configuration
 Warning: you will not be able to edit these selections. 
 How <span style="color:#66d9ef">do</span> you want users to be able to sign in? Username
 Do you want to configure advanced settings? No, I am <span style="color:#66d9ef">done</span>.
â Successfully added auth resource nextamplified22eac13d locally

â Some next steps:
<span style="color:#e6db74">&#34;amplify push&#34;</span> will build all your local backend resources and provision it in the cloud
<span style="color:#e6db74">&#34;amplify publish&#34;</span> will build all your local backend and frontend resources <span style="color:#f92672">(</span><span style="color:#66d9ef">if</span> you have hosting category added<span style="color:#f92672">)</span> and provision it in the cloud


â ï¸  WARNING: your GraphQL API currently allows public create, read, update, and delete access to all models via an API Key. To configure PRODUCTION-READY authorization rules, review: https://docs.amplify.aws/cli/graphql/authorization-rules

â GraphQL schema compiled successfully.

Edit your schema at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema.graphql or place .graphql files in a directory at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema

â ï¸  WARNING: your GraphQL API currently allows public create, read, update, and delete access to all models via an API Key. To configure PRODUCTION-READY authorization rules, review: https://docs.amplify.aws/cli/graphql/authorization-rules

â GraphQL schema compiled successfully.

Edit your schema at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema.graphql or place .graphql files in a directory at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema
â ¸ Building resource api/nextamplified
â ï¸  WARNING: your GraphQL API currently allows public create, read, update, and delete access to all models via an API Key. To configure PRODUCTION-READY authorization rules, review: https://docs.amplify.aws/cli/graphql/authorization-rules

â ¼ Building resource api/nextamplifiedâ GraphQL schema compiled successfully.

Edit your schema at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema.graphql or place .graphql files in a directory at /home/ec2-user/environment/next-amplified/amplify/backend/api/nextamplified/schema
? Do you want to update code <span style="color:#66d9ef">for</span> your updated GraphQL API Yes
? Do you want to generate GraphQL statements <span style="color:#f92672">(</span>queries, mutations and subscription<span style="color:#f92672">)</span> based on your schema types?
This will overwrite your current graphql queries, mutations and subscriptions Yes
â ¼ Updating resources in the cloud. This may take a few minutes...
...

</code></pre></div><p>This will add the authentication backend to our application, but we also need to update the frontend code to provide UI for signup, signin, forgot/reset password, MFA, etc. If you have implemented auth flows in an app before, you know that this can be quite complicated. Fortunately, Amplify makes this extremely easy. In your Cloud9 IDE, update <strong>pages/index.js</strong> with the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// pages/index.js
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>;
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Authenticator</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@aws-amplify/ui-react&#39;</span>;
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Amplify</span>, <span style="color:#a6e22e">API</span>, <span style="color:#a6e22e">withSSRContext</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;aws-amplify&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Head</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;next/head&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">awsExports</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../src/aws-exports&#39;</span>;
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">createPost</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../src/graphql/mutations&#39;</span>;
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">listPosts</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../src/graphql/queries&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">styles</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;../styles/Home.module.css&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;@aws-amplify/ui-react/styles.css&#39;</span>;


<span style="color:#a6e22e">Amplify</span>.<span style="color:#a6e22e">configure</span>({ ...<span style="color:#a6e22e">awsExports</span>, <span style="color:#a6e22e">ssr</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> });

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getServerSideProps</span>({ <span style="color:#a6e22e">req</span> }) {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">SSR</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">withSSRContext</span>({ <span style="color:#a6e22e">req</span> });
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">SSR</span>.<span style="color:#a6e22e">API</span>.<span style="color:#a6e22e">graphql</span>({ <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">listPosts</span> });

  <span style="color:#66d9ef">return</span> {
    <span style="color:#a6e22e">props</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">posts</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">listPosts</span>.<span style="color:#a6e22e">items</span>
    }
  };
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Home</span>(<span style="color:#a6e22e">props</span>) {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">posts</span>, <span style="color:#a6e22e">setPosts</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#a6e22e">props</span>.<span style="color:#a6e22e">posts</span> <span style="color:#f92672">||</span> []);
  
  <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleCreatePost</span>(<span style="color:#a6e22e">event</span>) {
    <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">preventDefault</span>();
  
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">form</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FormData</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">target</span>);
  
    <span style="color:#66d9ef">try</span> {
      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">data</span> } <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">API</span>.<span style="color:#a6e22e">graphql</span>({
        <span style="color:#a6e22e">authMode</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;AMAZON_COGNITO_USER_POOLS&#39;</span>,
        <span style="color:#a6e22e">query</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">createPost</span>,
        <span style="color:#a6e22e">variables</span><span style="color:#f92672">:</span> {
          <span style="color:#a6e22e">input</span><span style="color:#f92672">:</span> {
            <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;title&#39;</span>),
            <span style="color:#a6e22e">content</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;content&#39;</span>)
          }
        }
      });
      <span style="color:#75715e">// console.log(data);
</span><span style="color:#75715e"></span>      
      <span style="color:#a6e22e">setPosts</span>([
        ...<span style="color:#a6e22e">posts</span>,
        <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">createPost</span>
      ]);
  
    } <span style="color:#66d9ef">catch</span> ({ <span style="color:#a6e22e">errors</span> }) {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(...<span style="color:#a6e22e">errors</span>);
      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#a6e22e">errors</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">message</span>);
    }
  }

  <span style="color:#66d9ef">return</span> (
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">container</span>}<span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">Head</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Amplify</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">Next</span>.<span style="color:#a6e22e">js</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/title&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;icon&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/favicon.ico&#34;</span> <span style="color:#f92672">/&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/Head&gt;</span>

      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">main</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">main</span>}<span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h1</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">title</span>}<span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Amplify</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">Next</span>.<span style="color:#a6e22e">js</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/h1&gt;</span>

        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">description</span>}<span style="color:#f92672">&gt;</span>
          <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">code</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">code</span>}<span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">length</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/code&gt;</span>
          <span style="color:#a6e22e">posts</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>

        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">grid</span>}<span style="color:#f92672">&gt;</span>
          {<span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">post</span>) =&gt; (
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">a</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">card</span>} <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span>{<span style="color:#e6db74">`/posts/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>} <span style="color:#a6e22e">key</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">id</span>}<span style="color:#f92672">&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h3</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">title</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/h3&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">content</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/a&gt;</span>
          ))}

          <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">Authenticator</span><span style="color:#f92672">&gt;</span>
          <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">card</span>}<span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h3</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>.<span style="color:#a6e22e">title</span>}<span style="color:#f92672">&gt;</span><span style="color:#a6e22e">New</span> <span style="color:#a6e22e">Post</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/h3&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">form</span> <span style="color:#a6e22e">onSubmit</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleCreatePost</span>}<span style="color:#f92672">&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">fieldset</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">legend</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Title</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/legend&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span>
                  <span style="color:#a6e22e">defaultValue</span><span style="color:#f92672">=</span>{<span style="color:#e6db74">`Today, </span><span style="color:#e6db74">${</span><span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toLocaleTimeString</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>}
                  <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>
                <span style="color:#f92672">/&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/fieldset&gt;</span>

              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">fieldset</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">legend</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Content</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/legend&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">textarea</span>
                  <span style="color:#a6e22e">defaultValue</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;I built an Amplify app with Next.js!&#34;</span>
                  <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;content&#34;</span>
                <span style="color:#f92672">/&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/fieldset&gt;</span>

              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Create</span> <span style="color:#a6e22e">Post</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/button&gt;</span>
            <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/form&gt;</span>
          <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
          <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/Authenticator&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/main&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
  );
}
</code></pre></div><p>If you look closely, you&rsquo;ll see that we only updated 4 lines of code: Lines 3, 36, 81, and 104. Here&rsquo;s a brief description of each change.</p>
<ul>
<li><strong>Line 3</strong> - We&rsquo;re importing the Authenticator component from Amplify&rsquo;s React UI library. This component provides all of the UI needed for authentication including Sign up, Sign in, and Forgot/Reset Password screens.</li>
<li><strong>Line 36</strong> - Here, we&rsquo;re telling our <strong>createPost</strong> GraphQL query to use the newly created Cognito User Pool as the authMode for this request. This is needed because our schema updates from earlier now limit the creation of Posts to authenticated users only.</li>
<li><strong>Lines 81 and 104</strong> - These lines wrap our <strong>New Post</strong> form inside our Authenticator component, which prevents non-authenticated users from accessing the form to create Posts.</li>
</ul>
<p>Let&rsquo;s go ahead and restart our development server, so we can see our changes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm run dev
</code></pre></div><p>Remember to use the <strong>Preview Running Application</strong> feature to see our application.</p>
<p><img src="../images/amplify-authentication.png" alt="Amplify Authentication"></p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="../blogging-application/deploy-and-host-app.html" title="Deploy and Host App"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../summary.html" title="Summary" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js"></script>
    <script src="../js/perfect-scrollbar.min.js"></script>
    <script src="../js/perfect-scrollbar.jquery.min.js"></script>
    <script src="../js/jquery.sticky.js"></script>
    <script src="../js/featherlight.min.js"></script>
    <script src="../js/html5shiv-printshiv.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/modernizr.custom-3.6.0.js"></script>
    <script src="../js/learn.js"></script>
    <script src="../js/hugo-learn.js"></script>

    <link href="../mermaid/mermaid.css" rel="stylesheet" />
    <script src="../mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <div id = 'kinesisStreamName' title = ""/></div>
<div id = 'cognitoPoolId' title = ""/></div>
<div id = 'awsRegion' title = ""/></div>
<div id = 'contentId' title = ""/></div>
<div id = 'language' title = "en"/></div>
<div id = 'versions' title = ""/></div>

<script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
<script src="../js/kinesis.js"></script>
  </body>
</html>
